<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Open Internet or Unix domain socket connection</title>

 </head>
 <body><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.stream-socket-accept.html">stream_socket_accept</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.stream-socket-enable-crypto.html">stream_socket_enable_crypto</a></div>
 <div class="up"><a href="ref.stream.html">Stream Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.stream-socket-client" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">stream_socket_client</h1>
  <p class="verinfo">(PHP 5)</p><p class="refpurpose"><span class="refname">stream_socket_client</span> &mdash; <span class="dc-title">Open Internet or Unix domain socket connection</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.stream-socket-client-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><b>stream_socket_client</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$remote_socket</tt></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter reference">&$errno</tt></span>
   [, <span class="methodparam"><span class="type">string</span> <tt class="parameter reference">&$errstr</tt></span>
   [, <span class="methodparam"><span class="type">float</span> <tt class="parameter">$timeout</tt><span class="initializer"> = ini_get(&quot;default_socket_timeout&quot;)</span></span>
   [, <span class="methodparam"><span class="type">int</span> <tt class="parameter">$flags</tt><span class="initializer"> = STREAM_CLIENT_CONNECT</span></span>
   [, <span class="methodparam"><span class="type">resource</span> <tt class="parameter">$context</tt></span>
  ]]]]] )</div>

  <p class="para rdfs-comment">
   Initiates a stream or datagram connection to the destination specified
   by <i><tt class="parameter">remote_socket</tt></i>.  The type of socket created
   is determined by the transport specified using standard URL formatting:
   <i>transport://target</i>.  For Internet Domain sockets
   (AF_INET) such as TCP and UDP, the <i>target</i> portion
   of the <i><tt class="parameter">remote_socket</tt></i> parameter should consist of
   a hostname or IP address followed by a colon and a port number.  For Unix
   domain sockets, the <i><tt class="parameter">target</tt></i> portion should point
   to the socket file on the filesystem.
  </p>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    The stream will by default be opened in blocking mode.  You can
    switch it to non-blocking mode by using
    <span class="function"><a href="function.stream-set-blocking.html" class="function">stream_set_blocking()</a></span>.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.stream-socket-client-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">remote_socket</tt></i></span>
     <dd>

      <p class="para">
       Address to the socket to connect to.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">errno</tt></i></span>
     <dd>

      <p class="para">
       Will be set to the system level error number if connection fails.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">errstr</tt></i></span>
     <dd>

      <p class="para">
       Will be set to the system level error message if the connection fails.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">timeout</tt></i></span>
     <dd>

      <p class="para">
       Number of seconds until the <i>connect()</i> system call
       should timeout.
       <blockquote class="note"><p><b class="note">Note</b>: 
        <span class="simpara">
         This parameter only applies when not making asynchronous
         connection attempts.
        </span>
       </p></blockquote>
       <blockquote class="note"><p><b class="note">Note</b>: 
        <p class="para">
         To set a timeout for reading/writing data over the socket, use the
         <span class="function"><a href="function.stream-set-timeout.html" class="function">stream_set_timeout()</a></span>, as the
         <i><tt class="parameter">timeout</tt></i> only applies while making connecting
         the socket.
        </p>
       </p></blockquote>
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">flags</tt></i></span>
     <dd>

      <p class="para">
       Bitmask field which may be set to any combination of connection flags.
       Currently the select of connection flags is limited to
       <b><tt>STREAM_CLIENT_CONNECT</tt></b> (default),
       <b><tt>STREAM_CLIENT_ASYNC_CONNECT</tt></b> and
       <b><tt>STREAM_CLIENT_PERSISTENT</tt></b>.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">context</tt></i></span>
     <dd>

      <p class="para">
       A valid context resource created with <span class="function"><a href="function.stream-context-create.html" class="function">stream_context_create()</a></span>.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.stream-socket-client-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   On success a stream resource is returned which may
   be used together with the other file functions (such as
   <span class="function"><a href="function.fgets.html" class="function">fgets()</a></span>, <span class="function"><a href="function.fgetss.html" class="function">fgetss()</a></span>,
   <span class="function"><a href="function.fwrite.html" class="function">fwrite()</a></span>, <span class="function"><a href="function.fclose.html" class="function">fclose()</a></span>, and
   <span class="function"><a href="function.feof.html" class="function">feof()</a></span>), <b><tt>FALSE</tt></b> on failure.
  </p>
 </div>

 
 <div class="refsect1 errors" id="refsect1-function.stream-socket-client-errors">
  <h3 class="title">Errors/Exceptions</h3>
  <p class="para">
   On failure the <i><tt class="parameter">errno</tt></i> and
   <i><tt class="parameter">errstr</tt></i> arguments will be populated with the actual
   system level error that occurred in the system-level
   <i>connect()</i> call. If the value returned in
   <i><tt class="parameter">errno</tt></i> is <i>0</i> and the
   function returned <b><tt>FALSE</tt></b>, it is an indication that the error
   occurred before the <i>connect()</i> call. This is
   most likely due to a problem initializing the socket. Note that
   the <i><tt class="parameter">errno</tt></i> and
   <i><tt class="parameter">errstr</tt></i> arguments will always be passed by
   reference.
  </p>
 </div>

 
 
 <div class="refsect1 examples" id="refsect1-function.stream-socket-client-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="stream-socket-client.example.basic">
    <p><b>Example #1 <span class="function"><b>stream_socket_client()</b></span> example</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_socket_client</span><span style="color: #007700">(</span><span style="color: #DD0000">"tcp://www.example.com:80"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$errno</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$errstr</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">30</span><span style="color: #007700">);<br />if&nbsp;(!</span><span style="color: #0000BB">$fp</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$errstr</span><span style="color: #DD0000">&nbsp;(</span><span style="color: #0000BB">$errno</span><span style="color: #DD0000">)&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"GET&nbsp;/&nbsp;HTTP/1.0\r\nHost:&nbsp;www.example.com\r\nAccept:&nbsp;*/*\r\n\r\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(!</span><span style="color: #0000BB">feof</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">fgets</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1024</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="stream-socket-client.example.daytime">
    <p><b>Example #2 Using UDP connection</b></p>
    <div class="example-contents"><p>
     Retrieving the day and time from the UDP service &quot;daytime&quot; (port 13)
     on localhost.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_socket_client</span><span style="color: #007700">(</span><span style="color: #DD0000">"udp://127.0.0.1:13"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$errno</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$errstr</span><span style="color: #007700">);<br />if&nbsp;(!</span><span style="color: #0000BB">$fp</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"ERROR:&nbsp;</span><span style="color: #0000BB">$errno</span><span style="color: #DD0000">&nbsp;-&nbsp;</span><span style="color: #0000BB">$errstr</span><span style="color: #DD0000">&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">fread</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">26</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.stream-socket-client-notes">
  <h3 class="title">Notes</h3>
  <div class="warning"><b class="warning">Warning</b>
   <p class="simpara">
     UDP sockets will sometimes appear to have opened without an error,
     even if the remote host is unreachable.  The error will only
     become apparent when you read or write data to/from the socket.
     The reason for this is because UDP is a &quot;connectionless&quot; protocol,
     which means that the operating system does not try to establish
     a link for the socket until it actually needs to send or receive data.
   </p>
  </div>
  <blockquote class="note"><p><b class="note">Note</b>: <span class="simpara">When specifying a numerical IPv6 address
(e.g. <i>fe80::1</i>), you must enclose the IP in square
brackets—for example, <i>tcp://[fe80::1]:80</i>.</span></p></blockquote>
  <blockquote class="note"><p><b class="note">Note</b>: 
   <p class="para">
    Depending on the environment, the Unix domain or the optional
    connect timeout may not be available.  A list of available
    transports can be retrieved using <span class="function"><a href="function.stream-get-transports.html" class="function">stream_get_transports()</a></span>.
    See <a href="transports.html" class="xref">List of Supported Socket Transports</a> for a list of built in transports.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.stream-socket-client-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.stream-socket-server.html" class="function" rel="rdfs-seeAlso">stream_socket_server()</a> - Create an Internet or Unix domain server socket</span></li>
    <li class="member"><span class="function"><a href="function.stream-set-blocking.html" class="function" rel="rdfs-seeAlso">stream_set_blocking()</a> - Set blocking/non-blocking mode on a stream</span></li>
    <li class="member"><span class="function"><a href="function.stream-set-timeout.html" class="function" rel="rdfs-seeAlso">stream_set_timeout()</a> - Set timeout period on a stream</span></li>
    <li class="member"><span class="function"><a href="function.stream-select.html" class="function" rel="rdfs-seeAlso">stream_select()</a> - Runs the equivalent of the select() system call on the given
   arrays of streams with a timeout specified by tv_sec and tv_usec</span></li>
    <li class="member"><span class="function"><a href="function.fgets.html" class="function" rel="rdfs-seeAlso">fgets()</a> - Gets line from file pointer</span></li>
    <li class="member"><span class="function"><a href="function.fgetss.html" class="function" rel="rdfs-seeAlso">fgetss()</a> - Gets line from file pointer and strip HTML tags</span></li>
    <li class="member"><span class="function"><a href="function.fwrite.html" class="function" rel="rdfs-seeAlso">fwrite()</a> - Binary-safe file write</span></li>
    <li class="member"><span class="function"><a href="function.fclose.html" class="function" rel="rdfs-seeAlso">fclose()</a> - Closes an open file pointer</span></li>
    <li class="member"><span class="function"><a href="function.feof.html" class="function" rel="rdfs-seeAlso">feof()</a> - Tests for end-of-file on a file pointer</span></li>
    <li class="member"><a href="ref.curl.html" class="xref">cURL Functions</a></li>
   </ul>
  </p>
 </div>


</div><hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.stream-socket-accept.html">stream_socket_accept</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.stream-socket-enable-crypto.html">stream_socket_enable_crypto</a></div>
 <div class="up"><a href="ref.stream.html">Stream Functions</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
